<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Be My Valentine?</title>

<style>
body {
    margin: 0;
    height: 100vh;
    background: linear-gradient(135deg, #ff9a9e, #fad0c4);
    font-family: Arial, sans-serif;
    overflow: hidden;
    position: relative;
}

h1 {
    position: absolute;
    width: 100%;
    text-align: center;
    top: 20%;
    font-size: 2.5rem;
    color: white;
}

button {
    padding: 15px 30px;
    font-size: 1.2rem;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    position: absolute;
    z-index: 2;
}

#yesBtn {
    background-color: #ff4d6d;
    color: white;
    left: 45%;
    top: 50%;
}

#noBtn {
    background-color: white;
    color: #ff4d6d;
    left: 55%;
    top: 50%;
}

.success-container {
    position: absolute;
    width: 100%;
    text-align: center;
    top: 35%;
    display: none;
    z-index: 2;
}

.success-message {
    font-size: 2rem;
    color: white;
    margin-bottom: 20px;
}

.success-container img {
    width: 280px;
    border-radius: 20px;
}

.heart {
    position: absolute;
    font-size: 24px;
    animation: fall linear forwards;
}

@keyframes fall {
    to {
        transform: translateY(100vh);
        opacity: 0;
    }
}
</style>
</head>

<body>

<h1>Jennifer, Will you be my Valentine? üíñ</h1>
<button id="yesBtn">Yes</button>
<button id="noBtn">No</button>

<div class="success-container" id="successContainer">
    <div class="success-message">
        Knew you were gonna say YES! HEHEHE YAY üíï I love you!!!
    </div>
   <img src="https://media.giphy.com/media/vFKqnCdLPNOKc/giphy.gif" alt="Dancing Cat">
</div>

<audio id="loveSong" src="George_Micheal_-_Careless_Whisper_(mp3.pm).mp3"></audio>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<script>
const noBtn = document.getElementById("noBtn");
const yesBtn = document.getElementById("yesBtn");
const successContainer = document.getElementById("successContainer");
const loveSong = document.getElementById("loveSong");

let mouseX = window.innerWidth / 2;
let mouseY = window.innerHeight / 2;

// Start position
let posX = window.innerWidth * 0.55;
let posY = window.innerHeight * 0.5;

// Velocity
let velocityX = 0;
let velocityY = 0;

// Make it harder/impossible to click
const SAFE_DISTANCE = 320;     // runs away sooner (bigger bubble)
const MIN_PUSH = 2.0;          // minimum push even when barely inside bubble
const MAX_SPEED = 22;          // top speed
const FRICTION = 0.90;         // lower = more slippery/faster
const EDGE_BUFFER = 90;        // keeps it away from edges
const EDGE_FORCE = 0.9;        // steers away from edges
const WIGGLE = 0.6;            // small randomness so it never settles
const PREDICT_MS = 70;         // prediction horizon for cursor movement

// Track mouse velocity for prediction
let lastMouseX = mouseX, lastMouseY = mouseY;
let mouseVX = 0, mouseVY = 0;

document.addEventListener("mousemove", (e) => {
  mouseVX = e.clientX - lastMouseX;
  mouseVY = e.clientY - lastMouseY;
  lastMouseX = e.clientX;
  lastMouseY = e.clientY;

  mouseX = e.clientX;
  mouseY = e.clientY;
});

// If the user somehow gets their cursor ON the button, instantly relocate it
noBtn.addEventListener("mouseenter", () => {
  const rect = noBtn.getBoundingClientRect();
  const maxX = window.innerWidth - rect.width;
  const maxY = window.innerHeight - rect.height;

  posX = Math.random() * (maxX - 2 * EDGE_BUFFER) + EDGE_BUFFER;
  posY = Math.random() * (maxY - 2 * EDGE_BUFFER) + EDGE_BUFFER;

  velocityX += (Math.random() - 0.5) * 12;
  velocityY += (Math.random() - 0.5) * 12;
});

function clamp(v, min, max) {
  return Math.max(min, Math.min(max, v));
}

function animate() {
  const rect = noBtn.getBoundingClientRect();
  const w = rect.width;
  const h = rect.height;

  // Predict where the mouse is headed (makes it harder to ‚Äúfake out‚Äù)
  const predictFactor = PREDICT_MS / 16; // approx frames
  const targetMouseX = mouseX + mouseVX * predictFactor;
  const targetMouseY = mouseY + mouseVY * predictFactor;

  const centerX = posX + w / 2;
  const centerY = posY + h / 2;

  let dx = centerX - targetMouseX;
  let dy = centerY - targetMouseY;
  let dist = Math.hypot(dx, dy);

  // MAIN REPULSION: accelerates away; stronger when closer
  if (dist < SAFE_DISTANCE && dist > 0.0001) {
    const force = (SAFE_DISTANCE - dist) / SAFE_DISTANCE; // 0..1
    const accel = (MIN_PUSH + 10.0 * force * force);      // quadratic ramp
    velocityX += (dx / dist) * accel;
    velocityY += (dy / dist) * accel;
  }

  // EDGE STEERING (prevents corner traps): push inward before it hits edges
  const maxX = window.innerWidth - w;
  const maxY = window.innerHeight - h;

  if (posX < EDGE_BUFFER) velocityX += EDGE_FORCE * (1 - posX / EDGE_BUFFER);
  if (posX > maxX - EDGE_BUFFER) velocityX -= EDGE_FORCE * (1 - (maxX - posX) / EDGE_BUFFER);
  if (posY < EDGE_BUFFER) velocityY += EDGE_FORCE * (1 - posY / EDGE_BUFFER);
  if (posY > maxY - EDGE_BUFFER) velocityY -= EDGE_FORCE * (1 - (maxY - posY) / EDGE_BUFFER);

  // Tiny wiggle so it never settles into a stable spot
  velocityX += (Math.random() - 0.5) * WIGGLE;
  velocityY += (Math.random() - 0.5) * WIGGLE;

  // Apply friction
  velocityX *= FRICTION;
  velocityY *= FRICTION;

  // Cap speed (so it‚Äôs fast but not teleport-y)
  const speed = Math.hypot(velocityX, velocityY);
  if (speed > MAX_SPEED) {
    velocityX = (velocityX / speed) * MAX_SPEED;
    velocityY = (velocityY / speed) * MAX_SPEED;
  }

  posX += velocityX;
  posY += velocityY;

  // Hard clamp inside bounds (as a final safety)
  posX = clamp(posX, 0, maxX);
  posY = clamp(posY, 0, maxY);

  noBtn.style.left = posX + "px";
  noBtn.style.top = posY + "px";

  requestAnimationFrame(animate);
}

animate();

function createHearts() {
  for (let i = 0; i < 70; i++) {
    const heart = document.createElement("div");
    heart.classList.add("heart");
    heart.innerText = "üíñ";
    heart.style.left = Math.random() * 100 + "vw";
    heart.style.animationDuration = (3 + Math.random() * 2) + "s";
    document.body.appendChild(heart);
    setTimeout(() => heart.remove(), 5000);
  }
}

yesBtn.addEventListener("click", () => {
  yesBtn.style.display = "none";
  noBtn.style.display = "none";
  document.querySelector("h1").style.display = "none";
  successContainer.style.display = "block";

  // Start music on user interaction (required by browsers)
  loveSong.play().catch(() => { /* ignore autoplay blocks */ });

  confetti({
    particleCount: 300,
    spread: 140,
    origin: { y: 0.6 }
  });

  createHearts();
});
</script>

</body>
</html>
